var W=Object.defineProperty;var C=(a,e,s)=>e in a?W(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var g=(a,e,s)=>C(a,typeof e!="symbol"?e+"":e,s);import{d as D,a as E,b as R,e as B,r as p,f as v,w as M,c as w,g as u,M as G,o as _,h as V,i as t,u as c,N as b,j as $,k as I,l as U}from"./index-DdiYzPex.js";import{S as y,u as j,P as A,_ as J,a as L,b as O,c as H,d as T,e as q,f as z}from"./index-Bzxl02Tx.js";function K(a){return new Worker("/lookscanned.io/assets/apply-scan-effect.worker-yAPG4ird.js",{name:a==null?void 0:a.name})}const Q=async function(a,e){if(window.Worker)return await new Promise((s,n)=>{const o=new K;e&&e.addEventListener("abort",()=>{o.terminate(),n(new Error("Aborted"))}),o.onmessage=r=>{s(r.data),o.terminate()},o.onerror=r=>{n(r),o.terminate()},o.postMessage(a)});throw new Error("Web Workers are not supported in this browser")};class k{constructor(e){g(this,"config");this.config=e}async renderPage(e,s){return{blob:await Q({image:e,config:JSON.parse(JSON.stringify(this.config))},s==null?void 0:s.signal)}}}const X={rotate:1,rotate_var:.5,colorspace:"gray",blur:.5,noise:.25,border:!1,scale:2,brightness:1,yellowish:0,contrast:1,output_format:"image/jpeg"},Y={style:{"margin-bottom":"25px"}},se=D({__name:"MagicaScanView",setup(a){const{t:e}=E(),s=R();B({title:e("base.scanTitle")+" - "+e("base.title"),meta:[{name:"description",content:e("base.description")}]});const n=p(void 0);(async()=>{const i=await(await fetch(A)).blob(),d=new File([i],"example.pdf");n.value||(n.value=d)})();const r=p(X),m=v(()=>{if(n.value)return new z(n.value)}),f=p(new y(new k(r.value)));M(r,l=>{f.value=new y(new k(l))},{deep:!0});const S=v(()=>r.value.scale),{save:h,progress:P,saving:N,scannedPDF:x}=j(n,m,f,S),F=async()=>{try{await h(),s.success(e("actions.generateSuccess"))}catch(l){s.error(e("actions.generateError")+l.message)}};return(l,i)=>(_(),w(G,null,{default:u(()=>[V("div",Y,[t(J)]),t(c(U),{"x-gap":"25","y-gap":"25",cols:12,"item-responsive":"",responsive:"screen"},{default:u(()=>[t(c(b),{span:"12 s:5 m:4 l:3"},{default:u(()=>[t(c($),{vertical:""},{default:u(()=>[t(L,{"onUpdate:pdf":i[0]||(i[0]=d=>n.value=d)}),n.value?(_(),w(O,{key:0,pdf:n.value},null,8,["pdf"])):I("",!0),t(H,{config:r.value,"onUpdate:config":i[1]||(i[1]=d=>r.value=d)},null,8,["config"]),t(T,{onGenerate:F,progress:c(P),saving:c(N),pdf:c(x)},null,8,["progress","saving","pdf"])]),_:1})]),_:1}),t(c(b),{span:"12 s:7 m:8 l:9"},{default:u(()=>[t(q,{pdfRenderer:m.value,scanRenderer:f.value,scale:r.value.scale},null,8,["pdfRenderer","scanRenderer","scale"])]),_:1})]),_:1})]),_:1}))}});export{se as _};
