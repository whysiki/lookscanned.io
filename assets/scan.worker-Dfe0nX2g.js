(function(){"use strict";async function h(r,o,e,i,n){const l=createImageBitmap(o),m=createImageBitmap(i),t=r.getContext("2d");if(!t)throw new Error("Canvas not supported");const c=await l,a=c.width,s=c.height;r.width=a,r.height=s,t.fillStyle="white",t.fillRect(0,0,a,s),t.filter=`blur(${e.blur}px)`,e.colorspace==="gray"&&(t.filter+=" grayscale(1)"),t.filter+=` brightness(${e.brightness})`,t.filter+=` sepia(${e.yellowish})`,t.filter+=` contrast(${e.contrast})`,t.translate(a/2,s/2),t.rotate((e.rotate+e.rotate_var*Math.random())*Math.PI/180),t.translate(-a/2,-s/2),t.drawImage(c,0,0);const g=await m;t.drawImage(g,0,0,a,s),e.border&&(t.strokeStyle="black",t.lineWidth=1,t.strokeRect(0,0,a,s))}onmessage=async r=>{const{page:o,config:e,noise:i}=r.data,n=new OffscreenCanvas(1e3,1e3);await h(n,o,e,i);const l=await n.convertToBlob({type:e.output_format});postMessage(l)}})();
