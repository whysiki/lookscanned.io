var W=Object.defineProperty;var B=(a,e,s)=>e in a?W(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var g=(a,e,s)=>B(a,typeof e!="symbol"?e+"":e,s);import{d as C,a as D,b as E,e as R,r as p,f as v,w as M,c as w,g as d,M as V,o as _,h as $,i as t,u as c,N as b,j as G,k as I,l as O}from"./index-DBOuClg0.js";import{S as y,u as U,P as j,_ as J,a as L,b as T,c as A,d as H,e as X,f as q}from"./index-Bpyc1kPi.js";function z(a){return new Worker("/assets/apply-scan-effect.worker-BXk7NT2O.js",{name:a==null?void 0:a.name})}const K=async function(a,e){if(window.Worker)return await new Promise((s,n)=>{const o=new z;e&&e.addEventListener("abort",()=>{o.terminate(),n(new Error("Aborted"))}),o.onmessage=r=>{s(r.data),o.terminate()},o.onerror=r=>{n(r),o.terminate()},o.postMessage(a)});throw new Error("Web Workers are not supported in this browser")};class k{constructor(e){g(this,"config");this.config=e}async renderPage(e,s){return{blob:await K({image:e,config:JSON.parse(JSON.stringify(this.config))},s==null?void 0:s.signal)}}}const Q={rotate:1,rotate_var:.5,colorspace:"gray",blur:.5,noise:.25,border:!1,scale:2,brightness:1,yellowish:0,contrast:1,output_format:"image/jpeg"},Y={style:{"margin-bottom":"25px"}},se=C({__name:"MagicaScanView",setup(a){const{t:e}=D(),s=E();R({title:e("base.scanTitle")+" - "+e("base.title"),meta:[{name:"description",content:e("base.description")}]});const n=p(void 0);(async()=>{const i=await(await fetch(j)).blob(),u=new File([i],"example.pdf");n.value||(n.value=u)})();const r=p(Q),m=v(()=>{if(n.value)return new q(n.value)}),f=p(new y(new k(r.value)));M(r,l=>{f.value=new y(new k(l))},{deep:!0});const S=v(()=>r.value.scale),{save:h,progress:N,saving:P,scannedPDF:x}=U(n,m,f,S),F=async()=>{try{await h(),s.success(e("actions.generateSuccess"))}catch(l){s.error(e("actions.generateError")+l.message)}};return(l,i)=>(_(),w(V,null,{default:d(()=>[$("div",Y,[t(J)]),t(c(O),{"x-gap":"25","y-gap":"25",cols:12,"item-responsive":"",responsive:"screen"},{default:d(()=>[t(c(b),{span:"12 s:5 m:4 l:3"},{default:d(()=>[t(c(G),{vertical:""},{default:d(()=>[t(L,{"onUpdate:pdf":i[0]||(i[0]=u=>n.value=u)}),n.value?(_(),w(T,{key:0,pdf:n.value},null,8,["pdf"])):I("",!0),t(A,{config:r.value,"onUpdate:config":i[1]||(i[1]=u=>r.value=u)},null,8,["config"]),t(H,{onGenerate:F,progress:c(N),saving:c(P),pdf:c(x)},null,8,["progress","saving","pdf"])]),_:1})]),_:1}),t(c(b),{span:"12 s:7 m:8 l:9"},{default:d(()=>[t(X,{pdfRenderer:m.value,scanRenderer:f.value,scale:r.value.scale},null,8,["pdfRenderer","scanRenderer","scale"])]),_:1})]),_:1})]),_:1}))}});export{se as _};
